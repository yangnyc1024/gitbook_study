# Network in Network(NiN)

* NiN使用窗口形状为$$11×11$$、$$5×5$$和$$3×3$$的卷积层，输出通道数量与AlexNet中的相同。 每个NiN块后有一个最大汇聚层，汇聚窗口形状为$$3×3$$，步幅为2。
* NiN和AlexNet之间的一个显著区别是NiN完全取消了全连接层。 相反，NiN使用一个NiN块，其输出通道数等于标签类别的数量。最后放一个_全局平均汇聚层_（global average pooling layer），生成一个对数几率 （logits）。
* NiN设计的一个优点是，它显著减少了模型所需参数的数量。然而，在实践中，这种设计有时会增加训练模型的时间。
* LeNet、AlexNet和VGG都有一个共同的设计模式：通过一系列的卷积层与汇聚层来提取空间结构特征；然后通过全连接层对特征的表征进行处理。 AlexNet和VGG对LeNet的改进主要在于如何扩大和加深这两个模块。
* 或者，可以想象在这个过程的早期使用全连接层。然而，如果使用了全连接层，可能会完全放弃表征的空间结构。 _网络中的网络_（_NiN_）提供了一个非常简单的解决方案：在每个像素的通道上分别使用多层感知机 ([Lin _et al._, 2013](https://zh.d2l.ai/chapter\_references/zreferences.html#id93))

#### NiN块

* 卷积层的输入和输出由四维张量组成，张量的每个轴分别对应样本、通道、高度和宽度。
* 另外，全连接层的输入和输出通常是分别对应于样本和特征的二维张量。 NiN的想法是在每个像素位置（针对每个高度和宽度）应用一个全连接层。
* 如果我们将权重连接到每个空间位置，我们可以将其视为$$1×1$$卷积层，或作为在每个像素位置上独立作用的全连接层。 从另一个角度看，即将空间维度中的每个像素视为单个样本，将通道维度视为不同特征（feature）。
* 下面的图说明了VGG和NiN及它们的块之间主要架构差异。 NiN块以一个普通卷积层开始，后面是两个$$1×1$$的卷积层。这两个$$1×1$$卷积层充当带有ReLU激活函数的逐像素全连接层。 第一层的卷积窗口形状通常由用户设置。 随后的卷积窗口形状固定为$$1×1$$。
*

    <figure><img src="../../.gitbook/assets/Screenshot 2024-02-05 at 3.21.15 PM.png" alt=""><figcaption></figcaption></figure>



#### NiN模型

* 最初的NiN网络是在AlexNet后不久提出的，显然从中得到了一些启示。 NiN使用窗口形状为$$11×11$$、$$5×5$$和$$3×3$$的卷积层，输出通道数量与AlexNet中的相同。 每个NiN块后有一个最大汇聚层，汇聚窗口形状为$$3×3$$，步幅为2。
* NiN和AlexNet之间的一个显著区别是NiN完全取消了全连接层。 相反，NiN使用一个NiN块，其输出通道数等于标签类别的数量。最后放一个_全局平均汇聚层_（global average pooling layer），生成一个对数几率 （logits）。
* NiN设计的一个优点是，它显著减少了模型所需参数的数量。然而，在实践中，这种设计有时会增加训练模型的时间。

